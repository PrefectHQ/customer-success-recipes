## Requirements

| Name                                                                         | Version |
| ---------------------------------------------------------------------------- | ------- |
| <a name="requirement_terraform"></a> [terraform](#requirement\_terraform)    | 1.0.11  |
| <a name="requirement_kubernetes"></a> [kubernetes](#requirement\_kubernetes) | 2.5.0   |

## Providers

| Name                                                                   | Version |
| ---------------------------------------------------------------------- | ------- |
| <a name="provider_kubernetes"></a> [kubernetes](#provider\_kubernetes) | 2.5.0   |

## Modules

No modules.

## Resources

| Name                                                                                                                                    | Type        |
| --------------------------------------------------------------------------------------------------------------------------------------- | ----------- |
| [kubernetes_deployment.deployment](https://registry.terraform.io/providers/hashicorp/kubernetes/2.5.0/docs/resources/deployment)        | resource    |
| [kubernetes_namespace.namespace](https://registry.terraform.io/providers/hashicorp/kubernetes/2.5.0/docs/resources/namespace)           | resource    |
| [kubernetes_role.prefect_agent](https://registry.terraform.io/providers/hashicorp/kubernetes/2.5.0/docs/resources/role)                 | resource    |
| [kubernetes_role_binding.prefect_agent](https://registry.terraform.io/providers/hashicorp/kubernetes/2.5.0/docs/resources/role_binding) | resource    |
| [kubernetes_secret.api_key](https://registry.terraform.io/providers/hashicorp/kubernetes/2.5.0/docs/resources/secret)                   | resource    |
| [kubernetes_service_account.agent](https://registry.terraform.io/providers/hashicorp/kubernetes/2.5.0/docs/resources/service_account)   | resource    |
| [kubernetes_namespace.namespace](https://registry.terraform.io/providers/hashicorp/kubernetes/2.5.0/docs/data-sources/namespace)        | data source |

## Inputs

| Name                                                                                                                                  | Description                                                                                                                                                                          | Type                                                                                                            | Default                   | Required |
| ------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------- | ------------------------- | :------: |
| <a name="input_api"></a> [api](#input\_api)                                                                                           | Prefect backend API, defaults to Prefect cloud at ap.prefect.io                                                                                                                      | `string`                                                                                                        | `"api.prefect.io"`        |    no    |
| <a name="input_api_key"></a> [api\_key](#input\_api\_key)                                                                             | Prefect Cloud api key or (deprecated) token                                                                                                                                          | `any`                                                                                                           | n/a                       |   yes    |
| <a name="input_api_key_secret_name"></a> [api\_key\_secret\_name](#input\_api\_key\_secret\_name)                                     | Name of the kubernetes secret, requires `use_existing_secret` to be `True`                                                                                                           | `string`                                                                                                        | `"prefect-cloud-api-key"` |    no    |
| <a name="input_app"></a> [app](#input\_app)                                                                                           | app                                                                                                                                                                                  | `string`                                                                                                        | `"prefect-agent"`         |    no    |
| <a name="input_automount_service_account_token"></a> [automount\_service\_account\_token](#input\_automount\_service\_account\_token) | n/a                                                                                                                                                                                  | `bool`                                                                                                          | `true`                    |    no    |
| <a name="input_create_namespace"></a> [create\_namespace](#input\_create\_namespace)                                                  | Indicates whether to create a new namespace should be created                                                                                                                        | `bool`                                                                                                          | `true`                    |    no    |
| <a name="input_env_secrets"></a> [env\_secrets](#input\_env\_secrets)                                                                 | a list of maps of env vars to pull from secrets                                                                                                                                      | `list(any)`                                                                                                     | `[]`                      |    no    |
| <a name="input_env_values"></a> [env\_values](#input\_env\_values)                                                                    | a mapping of env vars to their values i.e. {ENV\_VAR = 'value'}                                                                                                                      | `map(any)`                                                                                                      | `{}`                      |    no    |
| <a name="input_image_pull_policy"></a> [image\_pull\_policy](#input\_image\_pull\_policy)                                             | n/a                                                                                                                                                                                  | `string`                                                                                                        | `"Always"`                |    no    |
| <a name="input_kube_cacert"></a> [kube\_cacert](#input\_kube\_cacert)                                                                 | n/a                                                                                                                                                                                  | `any`                                                                                                           | n/a                       |   yes    |
| <a name="input_kube_host"></a> [kube\_host](#input\_kube\_host)                                                                       | k8s auth                                                                                                                                                                             | `any`                                                                                                           | n/a                       |   yes    |
| <a name="input_limit_cpu"></a> [limit\_cpu](#input\_limit\_cpu)                                                                       | n/a                                                                                                                                                                                  | `string`                                                                                                        | `"500m"`                  |    no    |
| <a name="input_limit_mem"></a> [limit\_mem](#input\_limit\_mem)                                                                       | n/a                                                                                                                                                                                  | `string`                                                                                                        | `"128Mi"`                 |    no    |
| <a name="input_logging_level"></a> [logging\_level](#input\_logging\_level)                                                           | n/a                                                                                                                                                                                  | `string`                                                                                                        | `"INFO"`                  |    no    |
| <a name="input_namespace"></a> [namespace](#input\_namespace)                                                                         | n/a                                                                                                                                                                                  | `string`                                                                                                        | `"default"`               |    no    |
| <a name="input_node_affinity"></a> [node\_affinity](#input\_node\_affinity)                                                           | Node affinity settings                                                                                                                                                               | <pre>object({<br>    key      = string<br>    operator = string<br>    values   = tuple([string])<br>  })</pre> | `null`                    |    no    |
| <a name="input_prefect_labels"></a> [prefect\_labels](#input\_prefect\_labels)                                                        | n/a                                                                                                                                                                                  | `string`                                                                                                        | `"[]"`                    |    no    |
| <a name="input_prefect_version"></a> [prefect\_version](#input\_prefect\_version)                                                     | n/a                                                                                                                                                                                  | `string`                                                                                                        | `"latest"`                |    no    |
| <a name="input_replicas"></a> [replicas](#input\_replicas)                                                                            | n/a                                                                                                                                                                                  | `number`                                                                                                        | `1`                       |    no    |
| <a name="input_request_cpu"></a> [request\_cpu](#input\_request\_cpu)                                                                 | n/a                                                                                                                                                                                  | `string`                                                                                                        | `"100m"`                  |    no    |
| <a name="input_request_mem"></a> [request\_mem](#input\_request\_mem)                                                                 | resources                                                                                                                                                                            | `string`                                                                                                        | `"100Mi"`                 |    no    |
| <a name="input_secret_volumes"></a> [secret\_volumes](#input\_secret\_volumes)                                                        | n/a                                                                                                                                                                                  | `list(any)`                                                                                                     | `[]`                      |    no    |
| <a name="input_service_account_annotations"></a> [service\_account\_annotations](#input\_service\_account\_annotations)               | if supplied, a workload identity annotation will be placed on agent's serviceaccount--workload identity must also be enabled on the cluster and authorized on the GCP serviceaccount | `map(any)`                                                                                                      | `null`                    |    no    |
| <a name="input_service_account_name"></a> [service\_account\_name](#input\_service\_account\_name)                                    | n/a                                                                                                                                                                                  | `any`                                                                                                           | `null`                    |    no    |
| <a name="input_start_args"></a> [start\_args](#input\_start\_args)                                                                    | n/a                                                                                                                                                                                  | `string`                                                                                                        | `""`                      |    no    |
| <a name="input_use_existing_role"></a> [use\_existing\_role](#input\_use\_existing\_role)                                             | Indicates whether to use an existing role or not                                                                                                                                     | `bool`                                                                                                          | `false`                   |    no    |
| <a name="input_use_existing_secret"></a> [use\_existing\_secret](#input\_use\_existing\_secret)                                       | Indicates whether to use an existing kubernetes secret fot the prefect cloud API Key, requires `api_secret_name`                                                                     | `bool`                                                                                                          | `false`                   |    no    |
| <a name="input_volume_mounts"></a> [volume\_mounts](#input\_volume\_mounts)                                                           | n/a                                                                                                                                                                                  | `map(any)`                                                                                                      | `{}`                      |    no    |

## Outputs

| Name                                                                                | Description |
| ----------------------------------------------------------------------------------- | ----------- |
| <a name="output_deployment_name"></a> [deployment\_name](#output\_deployment\_name) | n/a         |
| <a name="output_namespace"></a> [namespace](#output\_namespace)                     | n/a         |
| <a name="output_version"></a> [version](#output\_version)                           | n/a         |